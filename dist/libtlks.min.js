function searchTalks(n,t,e,o,r,l){"use strict";r=r||1,MongoClient.connect(n,function(n,u){if(n)return l(n,null);var i=u.collection("talks");i.find(t).sort(e).skip(r>0?(r-1)*o:0).limit(o).toArray(function(n,t){return n?l(n,null):(u.close(),l(null,t))})})}var packagejson=require("./package.json");exports.version=packagejson.version,exports.talk=require("./lib/talk.js"),exports.user=require("./lib/user.js");var MongoClient=require("mongodb").MongoClient;exports.search=function(n,t,e){"use strict";var o=require("search-index")({indexPath:n});o.search(t,function(n,t){if(n)throw new Error(n);return e(null,t)})},exports.all=function(n,t){"use strict";MongoClient.connect(n,function(n,e){if(n)return t(n,null);var o=e.collection("talks");o.find({}).toArray(function(n,o){return n?t(n,null):(e.close(),t(null,o))})})},exports.latest=function(n,t,e,o){"use strict";var r={created:-1};return searchTalks(n,{},r,t,e,o)},exports.popular=function(n,t,e,o){"use strict";var r={},l={voteCount:-1,viewCount:-1};return searchTalks(n,r,l,t,e,o)},exports.createTalk=function(n,t,e){"use strict";MongoClient.connect(n,function(n,o){if(n)return e(n,null);var r=o.collection("talks");r.insert(t,function(n,t){return n?e(n,null):(o.close(),e(null,t))})})},exports.deleteTalk=function(n,t,e){"use strict";MongoClient.connect(n,function(n,o){if(n)return e(n,null);var r=o.collection("talks");r.remove({id:t},function(n,t){return n?e(n,null):(o.close(),e(null,t))})})},exports.get=function(n,t,e){"use strict";MongoClient.connect(n,function(n,o){if(n)return e(n,null);var r=o.collection("talks");r.findOne({id:t},function(n,t){return n?e(n,null):(o.close(),e(null,t))})})},exports.upvote=function(n,t,e,o){"use strict";MongoClient.connect(n,function(n,r){if(n)return o(n,null);var l=r.collection("talks");l.update({id:t,votes:{$ne:e}},{$inc:{voteCount:1},$push:{votes:e}},function(n,t){return n?o(n,null):(r.close(),o(null,t))})})},exports.favorite=function(n,t,e,o){"use strict";MongoClient.connect(n,function(n,r){if(n)return o(n,null);var l=r.collection("talks");l.update({id:t,favorites:{$ne:e}},{$inc:{favoriteCount:1},$push:{favorites:e}},function(n,t){return n?o(n,null):(r.close(),o(null,t))})})},exports.unfavorite=function(n,t,e,o){"use strict";MongoClient.connect(n,function(n,r){if(n)return o(n,null);var l=r.collection("talks");l.update({id:t,favorites:{$in:[e]}},{$inc:{favoriteCount:-1},$pull:{favorites:e}},function(n,t){return n?o(n,null):(r.close(),o(null,t))})})},exports.rank=function(n,t,e,o){"use strict";MongoClient.connect(n,function(n,r){if(n)return o(n,null);var l=r.collection("talks");l.update({id:t},{$set:{ranking:e}},function(n){return n?o(n):(r.close(),o(null))})})},exports.play=function(n,t,e){"use strict";MongoClient.connect(n,function(n,o){if(n)return e(n,null);var r=o.collection("talks");r.findOne({slug:t},function(n,l){return n?e(n,null):(l.viewCount=l.viewCount+1,void r.update({slug:t},{$inc:{viewCount:1},$set:{updated:Date.now()}},function(n){return n?e(n,null):(o.close(),e(null,l))}))})})},exports.getByTag=function(n,t,e,o,r){"use strict";var l={tags:t},u={created:-1};return searchTalks(n,l,u,e,o,r)},exports.getBySlug=function(n,t,e){"use strict";MongoClient.connect(n,function(n,o){if(n)return e(n,null);var r=o.collection("talks");r.find({slug:t}).toArray(function(n,t){return n?e(n,null):(o.close(),e(null,t))})})},exports.related=function(n,t,e,o,r){"use strict";MongoClient.connect(n,function(n,l){if(n)return r(n,null);var u=l.collection("talks");u.find({tags:{$in:e},id:{$ne:t}}).limit(o).toArray(function(n,t){return n?r(n,null):(l.close(),r(null,t))})})},exports.getByAuthorId=function(n,t,e){"use strict";MongoClient.connect(n,function(n,o){if(n)return e(n,null);var r=o.collection("talks");r.find({"author.id":t}).sort({created:-1}).toArray(function(n,t){return n?e(n,null):(o.close(),e(null,t))})})},exports.getUpvotedByAuthorId=function(n,t,e){"use strict";MongoClient.connect(n,function(n,o){if(n)return e(n,null);var r=o.collection("talks");r.find({votes:{$in:[t]}}).sort({created:-1}).toArray(function(n,t){return n?e(n,null):(o.close(),e(null,t))})})},exports.getFavoritedByAuthorId=function(n,t,e){"use strict";MongoClient.connect(n,function(n,o){if(n)return e(n,null);var r=o.collection("talks");r.find({favorites:{$in:[t]}}).sort({created:-1}).toArray(function(n,t){return n?e(n,null):(o.close(),e(null,t))})})};var MongoClient=require("mongodb").MongoClient;exports.getByUsername=function(n,t,e){"use strict";MongoClient.connect(n,function(n,o){if(n)return e(n,null);var r=o.collection("users");r.findOne({username:t},function(n,t){return n?e(n,null):(o.close(),void e(null,t))})})},exports.create=function(n,t,e){"use strict";MongoClient.connect(n,function(n,o){if(n)return e(n,null);var r=o.collection("users");r.insert(t,function(n,t){return n?e(n,null):(o.close(),void e(null,t))})})},exports.update=function(n,t,e){"use strict";MongoClient.connect(n,function(n,o){if(n)return e(n,null);var r=o.collection("users");r.update({id:t.id},{$set:{bio:t.bio,email:t.email,updated:Date.now()}},function(n){return n?e(n):(o.close(),void e(null))})})};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYnRsa3MubWluLmpzIl0sIm5hbWVzIjpbInNlYXJjaFRhbGtzIiwiZGJ1cmwiLCJjb25kcyIsInNvcnQiLCJxdWFudGl0eSIsInBhZ2VOdW1iZXIiLCJjYWxsYmFjayIsIk1vbmdvQ2xpZW50IiwiY29ubmVjdCIsImVyciIsImRiIiwidGFsa3MiLCJjb2xsZWN0aW9uIiwiZmluZCIsInNraXAiLCJsaW1pdCIsInRvQXJyYXkiLCJkb2NzIiwiY2xvc2UiLCJwYWNrYWdlanNvbiIsInJlcXVpcmUiLCJleHBvcnRzIiwidmVyc2lvbiIsInRhbGsiLCJ1c2VyIiwic2VhcmNoIiwiaW5kZXgiLCJxIiwic2kiLCJpbmRleFBhdGgiLCJyZXN1bHRzIiwiRXJyb3IiLCJhbGwiLCJsYXRlc3QiLCJjcmVhdGVkIiwicG9wdWxhciIsInZvdGVDb3VudCIsInZpZXdDb3VudCIsImNyZWF0ZVRhbGsiLCJvYmoiLCJpbnNlcnQiLCJkZWxldGVUYWxrIiwiaWQiLCJyZW1vdmUiLCJnZXQiLCJmaW5kT25lIiwiZG9jIiwidXB2b3RlIiwidXNlcmlkIiwidXBkYXRlIiwidm90ZXMiLCIkbmUiLCIkaW5jIiwiJHB1c2giLCJmYXZvcml0ZSIsImZhdm9yaXRlcyIsImZhdm9yaXRlQ291bnQiLCJ1bmZhdm9yaXRlIiwiJGluIiwiJHB1bGwiLCJyYW5rIiwic2NvcmUiLCIkc2V0IiwicmFua2luZyIsInBsYXkiLCJzbHVnIiwidXBkYXRlZCIsIkRhdGUiLCJub3ciLCJnZXRCeVRhZyIsInRhZyIsInRhZ3MiLCJnZXRCeVNsdWciLCJyZWxhdGVkIiwiZ2V0QnlBdXRob3JJZCIsImF1dGhvci5pZCIsImdldFVwdm90ZWRCeUF1dGhvcklkIiwiZ2V0RmF2b3JpdGVkQnlBdXRob3JJZCIsImdldEJ5VXNlcm5hbWUiLCJ1c2VybmFtZSIsInVzZXJzIiwicHJvZmlsZSIsImNyZWF0ZSIsImJpbyIsImVtYWlsIl0sIm1hcHBpbmdzIjoiQUE2RkEsUUFBU0EsYUFBWUMsRUFBT0MsRUFBT0Ms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U0FBVWYsRUFBS2UsR0FDOUIsTUFBSWYsR0FDT0gsRUFBU0csRUFBSyxPQUV6QkMsRUFBR1EsWUFDSFosR0FBUyxLQUFNa0IsU0FXM0JILFFBQVE0QixPQUFTLFNBQVNoRCxFQUFPdUIsRUFBTWxCLEdBQ25DLFlBQ0FDLGFBQVlDLFFBQVFQLEVBQU8sU0FBU1EsRUFBS0MsR0FDckMsR0FBSUQsRUFDQSxNQUFPSCxHQUFTRyxFQUFLLEtBRXpCLElBQUl1RSxHQUFRdEUsRUFBR0UsV0FBVyxRQUMxQm9FLEdBQU0vQixRQUFRUCxHQUFNbEIsRUFBS2tCLEtBQ3JCb0IsTUFDSXFCLElBQUszRCxFQUFLMkQsSUFDVkMsTUFBTzVELEVBQUs0RCxNQUNabEIsUUFBU0MsS0FBS0MsUUFFbkIsU0FBVTNELEdBQ1QsTUFBSUEsR0FDT0gsRUFBU0csSUFFcEJDLEVBQUdRLFlBQ0haLEdBQVMiLCJmaWxlIjoibGlidGxrcy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBzZWFyY2hUYWxrcyhuLHQsZSxvLHIsbCl7XCJ1c2Ugc3RyaWN0XCI7cj1yfHwxLE1vbmdvQ2xpZW50LmNvbm5lY3QobixmdW5jdGlvbihuLHUpe2lmKG4pcmV0dXJuIGwobixudWxsKTt2YXIgaT11LmNvbGxlY3Rpb24oXCJ0YWxrc1wiKTtpLmZpbmQodCkuc29ydChlKS5za2lwKHI+MD8oci0xKSpvOjApLmxpbWl0KG8pLnRvQXJyYXkoZnVuY3Rpb24obix0KXtyZXR1cm4gbj9sKG4sbnVsbCk6KHUuY2xvc2UoKSxsKG51bGwsdCkpfSl9KX12YXIgcGFja2FnZWpzb249cmVxdWlyZShcIi4vcGFja2FnZS5qc29uXCIpO2V4cG9ydHMudmVyc2lvbj1wYWNrYWdlanNvbi52ZXJzaW9uLGV4cG9ydHMudGFsaz1yZXF1aXJlKFwiLi9saWIvdGFsay5qc1wiKSxleHBvcnRzLnVzZXI9cmVxdWlyZShcIi4vbGliL3VzZXIuanNcIik7dmFyIE1vbmdvQ2xpZW50PXJlcXVpcmUoXCJtb25nb2RiXCIpLk1vbmdvQ2xpZW50O2V4cG9ydHMuc2VhcmNoPWZ1bmN0aW9uKG4sdCxlKXtcInVzZSBzdHJpY3RcIjt2YXIgbz1yZXF1aXJlKFwic2VhcmNoLWluZGV4XCIpKHtpbmRleFBhdGg6bn0pO28uc2VhcmNoKHQsZnVuY3Rpb24obix0KXtpZihuKXRocm93IG5ldyBFcnJvcihuKTtyZXR1cm4gZShudWxsLHQpfSl9LGV4cG9ydHMuYWxsPWZ1bmN0aW9uKG4sdCl7XCJ1c2Ugc3RyaWN0XCI7TW9uZ29DbGllbnQuY29ubmVjdChuLGZ1bmN0aW9uKG4sZSl7aWYobilyZXR1cm4gdChuLG51bGwpO3ZhciBvPWUuY29sbGVjdGlvbihcInRhbGtzXCIpO28uZmluZCh7fSkudG9BcnJheShmdW5jdGlvbihuLG8pe3JldHVybiBuP3QobixudWxsKTooZS5jbG9zZSgpLHQobnVsbCxvKSl9KX0pfSxleHBvcnRzLmxhdGVzdD1mdW5jdGlvbihuLHQsZSxvKXtcInVzZSBzdHJpY3RcIjt2YXIgcj17Y3JlYXRlZDotMX07cmV0dXJuIHNlYXJjaFRhbGtzKG4se30scix0LGUsbyl9LGV4cG9ydHMucG9wdWxhcj1mdW5jdGlvbihuLHQsZSxvKXtcInVzZSBzdHJpY3RcIjt2YXIgcj17fSxsPXt2b3RlQ291bnQ6LTEsdmlld0NvdW50Oi0xfTtyZXR1cm4gc2VhcmNoVGFsa3MobixyLGwsdCxlLG8pfSxleHBvcnRzLmNyZWF0ZVRhbGs9ZnVuY3Rpb24obix0LGUpe1widXNlIHN0cmljdFwiO01vbmdvQ2xpZW50LmNvbm5lY3QobixmdW5jdGlvbihuLG8pe2lmKG4pcmV0dXJuIGUobixudWxsKTt2YXIgcj1vLmNvbGxlY3Rpb24oXCJ0YWxrc1wiKTtyLmluc2VydCh0LGZ1bmN0aW9uKG4sdCl7cmV0dXJuIG4/ZShuLG51bGwpOihvLmNsb3NlKCksZShudWxsLHQpKX0pfSl9LGV4cG9ydHMuZGVsZXRlVGFsaz1mdW5jdGlvbihuLHQsZSl7XCJ1c2Ugc3RyaWN0XCI7TW9uZ29DbGllbnQuY29ubmVjdChuLGZ1bmN0aW9uKG4sbyl7aWYobilyZXR1cm4gZShuLG51bGwpO3ZhciByPW8uY29sbGVjdGlvbihcInRhbGtzXCIpO3IucmVtb3ZlKHtpZDp0fSxmdW5jdGlvbihuLHQpe3JldHVybiBuP2UobixudWxsKTooby5jbG9zZSgpLGUobnVsbCx0KSl9KX0pfSxleHBvcnRzLmdldD1mdW5jdGlvbihuLHQsZSl7XCJ1c2Ugc3RyaWN0XCI7TW9uZ29DbGllbnQuY29ubmVjdChuLGZ1bmN0aW9uKG4sbyl7aWYobilyZXR1cm4gZShuLG51bGwpO3ZhciByPW8uY29sbGVjdGlvbihcInRhbGtzXCIpO3IuZmluZE9uZSh7aWQ6dH0sZnVuY3Rpb24obix0KXtyZXR1cm4gbj9lKG4sbnVsbCk6KG8uY2xvc2UoKSxlKG51bGwsdCkpfSl9KX0sZXhwb3J0cy51cHZvdGU9ZnVuY3Rpb24obix0LGUsbyl7XCJ1c2Ugc3RyaWN0XCI7TW9uZ29DbGllbnQuY29ubmVjdChuLGZ1bmN0aW9uKG4scil7aWYobilyZXR1cm4gbyhuLG51bGwpO3ZhciBsPXIuY29sbGVjdGlvbihcInRhbGtzXCIpO2wudXBkYXRlKHtpZDp0LHZvdGVzOnskbmU6ZX19LHskaW5jOnt2b3RlQ291bnQ6MX0sJHB1c2g6e3ZvdGVzOmV9fSxmdW5jdGlvbihuLHQpe3JldHVybiBuP28obixudWxsKTooci5jbG9zZSgpLG8obnVsbCx0KSl9KX0pfSxleHBvcnRzLmZhdm9yaXRlPWZ1bmN0aW9uKG4sdCxlLG8pe1widXNlIHN0cmljdFwiO01vbmdvQ2xpZW50LmNvbm5lY3QobixmdW5jdGlvbihuLHIpe2lmKG4pcmV0dXJuIG8obixudWxsKTt2YXIgbD1yLmNvbGxlY3Rpb24oXCJ0YWxrc1wiKTtsLnVwZGF0ZSh7aWQ6dCxmYXZvcml0ZXM6eyRuZTplfX0seyRpbmM6e2Zhdm9yaXRlQ291bnQ6MX0sJHB1c2g6e2Zhdm9yaXRlczplfX0sZnVuY3Rpb24obix0KXtyZXR1cm4gbj9vKG4sbnVsbCk6KHIuY2xvc2UoKSxvKG51bGwsdCkpfSl9KX0sZXhwb3J0cy51bmZhdm9yaXRlPWZ1bmN0aW9uKG4sdCxlLG8pe1widXNlIHN0cmljdFwiO01vbmdvQ2xpZW50LmNvbm5lY3QobixmdW5jdGlvbihuLHIpe2lmKG4pcmV0dXJuIG8obixudWxsKTt2YXIgbD1yLmNvbGxlY3Rpb24oXCJ0YWxrc1wiKTtsLnVwZGF0ZSh7aWQ6dCxmYXZvcml0ZXM6eyRpbjpbZV19fSx7JGluYzp7ZmF2b3JpdGVDb3VudDotMX0sJHB1bGw6e2Zhdm9yaXRlczplfX0sZnVuY3Rpb24obix0KXtyZXR1cm4gbj9vKG4sbnVsbCk6KHIuY2xvc2UoKSxvKG51bGwsdCkpfSl9KX0sZXhwb3J0cy5yYW5rPWZ1bmN0aW9uKG4sdCxlLG8pe1widXNlIHN0cmljdFwiO01vbmdvQ2xpZW50LmNvbm5lY3QobixmdW5jdGlvbihuLHIpe2lmKG4pcmV0dXJuIG8obixudWxsKTt2YXIgbD1yLmNvbGxlY3Rpb24oXCJ0YWxrc1wiKTtsLnVwZGF0ZSh7aWQ6dH0seyRzZXQ6e3Jhbmtpbmc6ZX19LGZ1bmN0aW9uKG4pe3JldHVybiBuP28obik6KHIuY2xvc2UoKSxvKG51bGwpKX0pfSl9LGV4cG9ydHMucGxheT1mdW5jdGlvbihuLHQsZSl7XCJ1c2Ugc3RyaWN0XCI7TW9uZ29DbGllbnQuY29ubmVjdChuLGZ1bmN0aW9uKG4sbyl7aWYobilyZXR1cm4gZShuLG51bGwpO3ZhciByPW8uY29sbGVjdGlvbihcInRhbGtzXCIpO3IuZmluZE9uZSh7c2x1Zzp0fSxmdW5jdGlvbihuLGwpe3JldHVybiBuP2UobixudWxsKToobC52aWV3Q291bnQ9bC52aWV3Q291bnQrMSx2b2lkIHIudXBkYXRlKHtzbHVnOnR9LHskaW5jOnt2aWV3Q291bnQ6MX0sJHNldDp7dXBkYXRlZDpEYXRlLm5vdygpfX0sZnVuY3Rpb24obil7cmV0dXJuIG4/ZShuLG51bGwpOihvLmNsb3NlKCksZShudWxsLGwpKX0pKX0pfSl9LGV4cG9ydHMuZ2V0QnlUYWc9ZnVuY3Rpb24obix0LGUsbyxyKXtcInVzZSBzdHJpY3RcIjt2YXIgbD17dGFnczp0fSx1PXtjcmVhdGVkOi0xfTtyZXR1cm4gc2VhcmNoVGFsa3MobixsLHUsZSxvLHIpfSxleHBvcnRzLmdldEJ5U2x1Zz1mdW5jdGlvbihuLHQsZSl7XCJ1c2Ugc3RyaWN0XCI7TW9uZ29DbGllbnQuY29ubmVjdChuLGZ1bmN0aW9uKG4sbyl7aWYobilyZXR1cm4gZShuLG51bGwpO3ZhciByPW8uY29sbGVjdGlvbihcInRhbGtzXCIpO3IuZmluZCh7c2x1Zzp0fSkudG9BcnJheShmdW5jdGlvbihuLHQpe3JldHVybiBuP2UobixudWxsKTooby5jbG9zZSgpLGUobnVsbCx0KSl9KX0pfSxleHBvcnRzLnJlbGF0ZWQ9ZnVuY3Rpb24obix0LGUsbyxyKXtcInVzZSBzdHJpY3RcIjtNb25nb0NsaWVudC5jb25uZWN0KG4sZnVuY3Rpb24obixsKXtpZihuKXJldHVybiByKG4sbnVsbCk7dmFyIHU9bC5jb2xsZWN0aW9uKFwidGFsa3NcIik7dS5maW5kKHt0YWdzOnskaW46ZX0saWQ6eyRuZTp0fX0pLmxpbWl0KG8pLnRvQXJyYXkoZnVuY3Rpb24obix0KXtyZXR1cm4gbj9yKG4sbnVsbCk6KGwuY2xvc2UoKSxyKG51bGwsdCkpfSl9KX0sZXhwb3J0cy5nZXRCeUF1dGhvcklkPWZ1bmN0aW9uKG4sdCxlKXtcInVzZSBzdHJpY3RcIjtNb25nb0NsaWVudC5jb25uZWN0KG4sZnVuY3Rpb24obixvKXtpZihuKXJldHVybiBlKG4sbnVsbCk7dmFyIHI9by5jb2xsZWN0aW9uKFwidGFsa3NcIik7ci5maW5kKHtcImF1dGhvci5pZFwiOnR9KS5zb3J0KHtjcmVhdGVkOi0xfSkudG9BcnJheShmdW5jdGlvbihuLHQpe3JldHVybiBuP2UobixudWxsKTooby5jbG9zZSgpLGUobnVsbCx0KSl9KX0pfSxleHBvcnRzLmdldFVwdm90ZWRCeUF1dGhvcklkPWZ1bmN0aW9uKG4sdCxlKXtcInVzZSBzdHJpY3RcIjtNb25nb0NsaWVudC5jb25uZWN0KG4sZnVuY3Rpb24obixvKXtpZihuKXJldHVybiBlKG4sbnVsbCk7dmFyIHI9by5jb2xsZWN0aW9uKFwidGFsa3NcIik7ci5maW5kKHt2b3Rlczp7JGluOlt0XX19KS5zb3J0KHtjcmVhdGVkOi0xfSkudG9BcnJheShmdW5jdGlvbihuLHQpe3JldHVybiBuP2UobixudWxsKTooby5jbG9zZSgpLGUobnVsbCx0KSl9KX0pfSxleHBvcnRzLmdldEZhdm9yaXRlZEJ5QXV0aG9ySWQ9ZnVuY3Rpb24obix0LGUpe1widXNlIHN0cmljdFwiO01vbmdvQ2xpZW50LmNvbm5lY3QobixmdW5jdGlvbihuLG8pe2lmKG4pcmV0dXJuIGUobixudWxsKTt2YXIgcj1vLmNvbGxlY3Rpb24oXCJ0YWxrc1wiKTtyLmZpbmQoe2Zhdm9yaXRlczp7JGluOlt0XX19KS5zb3J0KHtjcmVhdGVkOi0xfSkudG9BcnJheShmdW5jdGlvbihuLHQpe3JldHVybiBuP2UobixudWxsKTooby5jbG9zZSgpLGUobnVsbCx0KSl9KX0pfTt2YXIgTW9uZ29DbGllbnQ9cmVxdWlyZShcIm1vbmdvZGJcIikuTW9uZ29DbGllbnQ7ZXhwb3J0cy5nZXRCeVVzZXJuYW1lPWZ1bmN0aW9uKG4sdCxlKXtcInVzZSBzdHJpY3RcIjtNb25nb0NsaWVudC5jb25uZWN0KG4sZnVuY3Rpb24obixvKXtpZihuKXJldHVybiBlKG4sbnVsbCk7dmFyIHI9by5jb2xsZWN0aW9uKFwidXNlcnNcIik7ci5maW5kT25lKHt1c2VybmFtZTp0fSxmdW5jdGlvbihuLHQpe3JldHVybiBuP2UobixudWxsKTooby5jbG9zZSgpLHZvaWQgZShudWxsLHQpKX0pfSl9LGV4cG9ydHMuY3JlYXRlPWZ1bmN0aW9uKG4sdCxlKXtcInVzZSBzdHJpY3RcIjtNb25nb0NsaWVudC5jb25uZWN0KG4sZnVuY3Rpb24obixvKXtpZihuKXJldHVybiBlKG4sbnVsbCk7dmFyIHI9by5jb2xsZWN0aW9uKFwidXNlcnNcIik7ci5pbnNlcnQodCxmdW5jdGlvbihuLHQpe3JldHVybiBuP2UobixudWxsKTooby5jbG9zZSgpLHZvaWQgZShudWxsLHQpKX0pfSl9LGV4cG9ydHMudXBkYXRlPWZ1bmN0aW9uKG4sdCxlKXtcInVzZSBzdHJpY3RcIjtNb25nb0NsaWVudC5jb25uZWN0KG4sZnVuY3Rpb24obixvKXtpZihuKXJldHVybiBlKG4sbnVsbCk7dmFyIHI9by5jb2xsZWN0aW9uKFwidXNlcnNcIik7ci51cGRhdGUoe2lkOnQuaWR9LHskc2V0OntiaW86dC5iaW8sZW1haWw6dC5lbWFpbCx1cGRhdGVkOkRhdGUubm93KCl9fSxmdW5jdGlvbihuKXtyZXR1cm4gbj9lKG4pOihvLmNsb3NlKCksdm9pZCBlKG51bGwpKX0pfSl9OyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==